<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Estimates â€” {{ token.company_name }}</title>
    <link rel="stylesheet" href="/static/css/style.css?v={{ cache_bust }}">
    <link rel="apple-touch-icon" href="/static/icons/apple-touch-icon.png">
    <link rel="manifest" href="/c/{{ token.token }}/manifest.json">
    <meta name="theme-color" content="#ffffff">
</head>
<body>
    <div class="capture-container">
        <div class="capture-header">
            {% if token.logo_file %}
            <div class="header-row">
                <img src="/static/logos/{{ token.logo_file }}" alt="{{ token.company_name }}" class="company-logo">
                <div class="header-text">
                    <div class="company-name">{{ token.company_name }}</div>
                    <h1>My Estimates</h1>
                </div>
            </div>
            {% else %}
            <div class="company-name">{{ token.company_name }}</div>
            <h1>My Estimates</h1>
            {% endif %}
            <div style="display: flex; gap: 8px;">
                <a href="/estimate?token={{ token.token }}" class="back-to-home">New Estimate</a>
                <a href="/c/{{ token.token }}" class="back-to-home">Home</a>
            </div>
        </div>

        {% if estimates %}
        {% for e in estimates %}
        <a href="/my-estimates/{{ e.id }}?token={{ token.token }}" style="text-decoration: none; color: inherit; display: block;">
            <div class="meta-card" style="padding: 12px; margin-bottom: 10px; border-left: 4px solid {% if e.status == 'complete' %}var(--green){% elif e.status == 'error' %}var(--red){% else %}var(--orange, #f59e0b){% endif %};">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <strong style="font-size: 15px;">{{ e.job_name or 'Unknown Job' }}</strong>
                    {% if e.status == 'complete' %}
                    <span class="badge badge-active" style="font-size: 10px;">Complete</span>
                    {% elif e.status == 'error' %}
                    <span class="badge" style="background: #fee2e2; color: #991b1b; font-size: 10px;">Error</span>
                    {% else %}
                    <span class="badge" style="background: #fef3c7; color: #92400e; font-size: 10px;">Processing</span>
                    {% endif %}
                </div>
                <div style="font-size: 12px; color: var(--gray-500); margin-top: 4px;">{{ e.created_at[:10] if e.created_at else '' }}</div>
                {% if e.title %}
                <div style="font-size: 13px; color: var(--gray-600); margin-top: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ e.title[:80] }}</div>
                {% elif e.transcription %}
                <div style="font-size: 13px; color: var(--gray-600); margin-top: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ e.transcription[:80] }}</div>
                {% endif %}
            </div>
        </a>
        {% endfor %}
        {% else %}
        <div style="text-align: center; padding: 32px; color: var(--gray-500);">
            <p>No estimates yet.</p>
            <a href="/estimate?token={{ token.token }}" class="btn btn-blue" style="margin-top: 12px;">Create First Estimate</a>
        </div>
        {% endif %}
    </div>
    {% include '_footer.html' %}
</body>
</html>
