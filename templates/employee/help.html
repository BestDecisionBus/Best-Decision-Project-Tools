<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help{% if token %} — {{ token.company_name }}{% endif %} — BDB Tools</title>
    <link rel="stylesheet" href="/static/css/style.css?v={{ cache_bust }}">
</head>
<body>
    <div class="help-container">
        <div class="help-header">
            <h1>BDB Tools Help</h1>
            {% if token %}
            <p class="help-subtitle">{{ token.company_name }}</p>
            <div style="text-align: right; margin-top: 8px;">
                <a href="/c/{{ token.token }}" class="btn btn-blue">Back to Home</a>
            </div>
            {% endif %}
        </div>

        <div class="help-section" style="background: var(--gray-50); border-radius: 8px; padding: 14px 16px;">
            <h2 style="margin-top: 0; font-size: 16px;">Quick Navigation</h2>
            <div style="font-size: 14px; line-height: 2;">
                <a href="#company-home">Company Home</a><br>
                {% if not employee or employee.timekeeper_access %}
                <a href="#clock-in">How to Clock In</a><br>
                <a href="#clock-out">How to Clock Out</a><br>
                <a href="#todays-punches">Viewing Today's Punches</a><br>
                {% endif %}
                {% if not employee or employee.receipt_access %}
                <a href="#submit-receipt">How to Submit a Receipt</a><br>
                <a href="#receipt-library">Receipt Library</a><br>
                {% endif %}
                {% if not employee or employee.schedule_access %}
                <a href="#view-schedule">How to View Your Schedule</a><br>
                {% endif %}
                {% if not employee or employee.job_photos_access %}
                <a href="#submit-photo">How to Submit a Job Photo</a><br>
                <a href="#photo-library">Photo Library</a><br>
                <a href="#job-files">Job Files</a><br>
                {% endif %}
                {% if not employee or employee.estimate_access %}
                <a href="#submit-estimate">How to Submit an Estimate</a><br>
                <a href="#my-estimates">Viewing Your Estimates</a><br>
                {% endif %}
                <a href="#gps">GPS Permissions</a><br>
                {% if not employee or employee.timekeeper_access %}
                <a href="#forgot-clock-out">Forgot to Clock Out?</a><br>
                <a href="#forgot-clock-in">Forgot to Clock In?</a><br>
                {% endif %}
                <a href="#need-help">Need Help?</a>
            </div>
        </div>

        <div class="help-section" id="company-home">
            <h2>Company Home</h2>
            <p>After logging in, the home screen gives you access to your enabled tools:</p>
            <ul>
                {% if not employee or employee.timekeeper_access %}
                <li><strong>Timekeeper</strong> — Clock in and out of jobs with GPS tracking.</li>
                {% endif %}
                {% if not employee or employee.job_photos_access %}
                <li><strong>Job Photos / Files</strong> — Take and submit photos of job sites, and view uploaded documents.</li>
                {% endif %}
                {% if not employee or employee.schedule_access %}
                <li><strong>Your Schedule</strong> — View your upcoming work schedule.</li>
                {% endif %}
                {% if not employee or employee.receipt_access %}
                <li><strong>Receipt Capture</strong> — Photograph receipts and record a voice memo.</li>
                {% endif %}
                {% if not employee or employee.estimate_access %}
                <li><strong>Job Estimate</strong> — Capture on-site estimates with photos and voice memos.</li>
                <li><strong>View Estimates</strong> — Review and edit your submitted estimates.</li>
                {% endif %}
            </ul>
        </div>

        {% if not employee or employee.timekeeper_access %}
        <div class="help-section" id="clock-in">
            <h2>How to Clock In</h2>
            <ol>
                <li>Tap <strong>Timekeeper</strong> from the home screen.</li>
                <li>Choose the <strong>job</strong> you are working on from the dropdown.</li>
                <li>Tap the <strong>CLOCK IN</strong> button.</li>
                <li>Your clock-in time and GPS location will be recorded.</li>
            </ol>
        </div>

        <div class="help-section" id="clock-out">
            <h2>How to Clock Out</h2>
            <ol>
                <li>Return to the Timekeeper page (you should still be logged in).</li>
                <li>If you are currently clocked in, the system will show your active shift details.</li>
                <li>Tap the <strong>CLOCK OUT</strong> button.</li>
                <li>Your clock-out time and GPS location will be recorded.</li>
            </ol>
        </div>

        <div class="help-section" id="todays-punches">
            <h2>Viewing Today's Punches</h2>
            <p>On the Timekeeper page, all of your time entries for today are displayed at the bottom. This includes:</p>
            <ul>
                <li>Clock-in and clock-out times</li>
                <li>The job associated with each entry</li>
                <li>Total hours worked for each entry</li>
            </ul>
        </div>
        {% endif %}

        {% if not employee or employee.receipt_access %}
        <div class="help-section" id="submit-receipt">
            <h2>How to Submit a Receipt</h2>
            <ol>
                <li>Tap <strong>Receipt Capture</strong> from the home screen.</li>
                <li><strong>Take a photo</strong> of the receipt using your device camera, or tap <strong>Upload from Library</strong> to select a photo you already took (useful if you were offline). Review the image and tap "Looks Good" to confirm.</li>
                <li><strong>Select details:</strong> Choose the job the receipt is for (required) and optionally select one or two expense categories.</li>
                <li><strong>Record a voice memo:</strong> Tap the record button and speak clearly. Describe the job, the trade, the credit card or bank account used, amounts for any category splits, and anything else missing from the receipt. For contactless payments (Apple Pay, tap to pay), you must say which bank account the card is tied to.</li>
                <li>Tap <strong>Submit</strong> and wait for confirmation.</li>
            </ol>
        </div>

        <div class="help-section" id="receipt-library">
            <h2>Receipt Library</h2>
            <p>The Receipt Library lets you browse all receipts you have submitted.</p>
            <ol>
                <li>From the Receipt Capture page, tap <strong>View Receipt Library</strong> at the bottom.</li>
                <li>Select a <strong>job</strong> to see all receipts for that job.</li>
                <li>Use the <strong>search</strong> box to find receipts by transcription text (vendor name, amount, etc.).</li>
                <li>Use the <strong>date filters</strong> to narrow results to a specific time period.</li>
                <li>Tap any receipt to see the full image, transcription, job, and category details.</li>
            </ol>
        </div>
        {% endif %}

        {% if not employee or employee.schedule_access %}
        <div class="help-section" id="view-schedule">
            <h2>How to View Your Schedule</h2>
            <ol>
                <li>Tap <strong>Your Schedule</strong> from the home screen.</li>
                <li>Your upcoming shifts for the next two weeks are displayed, showing the date, job, start time, and end time.</li>
            </ol>
        </div>
        {% endif %}

        {% if not employee or employee.job_photos_access %}
        <div class="help-section" id="submit-photo">
            <h2>How to Submit a Job Photo</h2>
            <ol>
                <li>Tap <strong>Job Photos / Files</strong> from the home screen.</li>
                <li>Select the <strong>job</strong> from the dropdown.</li>
                <li>Take a photo using your device camera, or tap <strong>Upload from Library</strong> to select photos from your device. You can select multiple photos at once for batch upload.</li>
                <li>Optionally type a <strong>caption</strong> for each photo.</li>
                <li>Tap <strong>Submit Photo</strong> (or <strong>Upload All Photos</strong> for batch) and wait for confirmation.</li>
            </ol>
            <p>Your GPS location is automatically captured and embedded in the photo so your employer can verify the job site location.</p>
        </div>

        <div class="help-section" id="photo-library">
            <h2>Photo Library</h2>
            <p>The Photo Library lets you browse all photos uploaded for your jobs.</p>
            <ol>
                <li>From the Job Photos page, tap <strong>View Photo Library</strong>.</li>
                <li>Select a <strong>job</strong> to see all photos for that job.</li>
                <li>Use the <strong>search</strong> box to find photos by caption.</li>
                <li>Use the <strong>date filters</strong> to narrow results to a specific time period.</li>
                <li>Tap any photo to see the full-size image with GPS location on a map.</li>
            </ol>
        </div>

        <div class="help-section" id="job-files">
            <h2>Job Files</h2>
            <p>The Job Files view lets you browse non-image documents uploaded to your jobs, such as PDFs, scope of work documents, and other files.</p>
            <ol>
                <li>From the Job Photos page, tap <strong>View Job Files</strong>.</li>
                <li>Select a <strong>job</strong> to see all files for that job.</li>
                <li>Tap any file to view its details. For PDFs, you can open the document directly in your browser.</li>
            </ol>
        </div>
        {% endif %}

        {% if not employee or employee.estimate_access %}
        <div class="help-section" id="submit-estimate">
            <h2>How to Submit an Estimate</h2>
            <ol>
                <li>Tap <strong>Job Estimate</strong> from the home screen.</li>
                <li>Select the <strong>job</strong> from the dropdown. If the job doesn't exist yet, tap <strong>Add New Job</strong> to create one — enter the job name and address, and the system will automatically look up the GPS coordinates.</li>
                <li>Enter a <strong>title</strong> for the estimate (e.g., "Kitchen remodel" or "Deck repair").</li>
                <li>Optionally take <strong>photos</strong> of the job site — these are attached to the job and visible to your admin. You can take multiple photos.</li>
                <li>Add any <strong>notes</strong> describing the scope of work, materials needed, or conditions observed.</li>
                <li>Optionally <strong>record a voice memo</strong> — tap the record button and describe the estimate details. The system will automatically transcribe your recording.</li>
                <li>Tap <strong>Submit</strong> and wait for confirmation. If you recorded audio, the system will process and transcribe it (this may take a moment).</li>
            </ol>
        </div>

        <div class="help-section" id="my-estimates">
            <h2>Viewing Your Estimates</h2>
            <p>View and edit all your submitted estimates from the <strong>View Estimates</strong> link on the home screen.</p>
            <ul>
                <li>Each estimate shows the job name, date, title, and a status badge:
                    <ul>
                        <li><strong>Complete</strong> (green) — Ready for review and editing.</li>
                        <li><strong>Processing</strong> (orange) — Voice memo is still being transcribed.</li>
                        <li><strong>Error</strong> (red) — Transcription failed. You can still edit the estimate manually.</li>
                    </ul>
                </li>
                <li>Tap an estimate to open the detail view where you can:
                    <ul>
                        <li>Review and edit the <strong>transcription</strong> of your voice memo.</li>
                        <li>Add or update <strong>notes</strong>.</li>
                        <li>View all <strong>photos</strong> attached to the job (tap to view full size).</li>
                        <li>Download a <strong>Scope of Work PDF</strong> document.</li>
                    </ul>
                </li>
            </ul>
        </div>
        {% endif %}

        <div class="help-section" id="gps">
            <h2>GPS Permissions</h2>
            <p>The Timekeeper and Job Photos tools use your device's GPS to record your location. Your employer uses this to verify you are at the correct job site.</p>
            <p><strong>How to enable GPS:</strong></p>
            <ul>
                <li><strong>iPhone:</strong> Go to Settings &gt; Privacy &gt; Location Services &gt; enable for your browser (Safari/Chrome).</li>
                <li><strong>Android:</strong> Go to Settings &gt; Location &gt; turn on. Then allow location access when your browser prompts you.</li>
            </ul>
            <p>If GPS is unavailable, the system will still allow you to clock in/out and submit photos, but your location will not be recorded.</p>
        </div>

        {% if not employee or employee.timekeeper_access %}
        <div class="help-section" id="forgot-clock-out">
            <h2>Forgot to Clock Out?</h2>
            <p>You cannot clock in to a new shift while the previous one is still open. If you forgot to clock out yesterday:</p>
            <ol>
                <li>Tap <strong>CLOCK OUT</strong> now to close the old shift (the time will be wrong — that's OK).</li>
                <li>Tap <strong>CLOCK IN</strong> to start your new shift as normal.</li>
                <li>Tell your administrator what time you actually left the previous job so they can correct the punch.</li>
            </ol>
            <p>The administrator will fix the clock-out time on the old entry. Do not worry about the incorrect time — just get clocked in so your current shift is tracked.</p>
        </div>

        <div class="help-section" id="forgot-clock-in">
            <h2>Forgot to Clock In?</h2>
            <p>If you forgot to clock in when you arrived at a job:</p>
            <ol>
                <li>Clock in <strong>as soon as you remember</strong>, even if you have been working for a while.</li>
                <li>Tell your administrator what time you actually started so they can correct the punch.</li>
            </ol>
            <p>It is better to have a late clock-in than no clock-in at all. Your administrator can adjust the start time.</p>
        </div>
        {% endif %}

        <div class="help-section" id="need-help">
            <h2>Need Help?</h2>
            <p>For any issues, contact your company administrator. They can:</p>
            <ul>
                <li>Add or edit manual time entries</li>
                <li>Correct clock-in/out mistakes</li>
                <li>Add new jobs or update existing ones</li>
                <li>Reset your password</li>
            </ul>
        </div>

        {% if token %}
        <div class="help-back" style="margin-top: 24px;">
            <a href="/c/{{ token.token }}" class="btn btn-blue">Back to Home</a>
        </div>
        {% endif %}
    </div>
    {% include '_footer.html' %}
</body>
</html>
